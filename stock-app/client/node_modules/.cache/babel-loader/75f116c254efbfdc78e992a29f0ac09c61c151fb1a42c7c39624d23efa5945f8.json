{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Marina\\\\Desktop\\\\Mon_Projet\\\\stock-app\\\\client\\\\src\\\\components\\\\ItemList.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport StockEvolutionGraph from './StockEvolutionGraph';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ItemList = ({\n  refresh\n}) => {\n  _s();\n  const [items, setItems] = useState([]);\n  const [showGraphId, setShowGraphId] = useState(null);\n  const [quantityInputs, setQuantityInputs] = useState({}); // State for quantity input fields\n\n  useEffect(() => {\n    const fetchItems = async () => {\n      try {\n        const config = {\n          headers: {\n            'x-auth-token': localStorage.getItem('token')\n          }\n        };\n        const res = await axios.get('/api/items', config);\n        setItems(res.data);\n        // Initialize quantity inputs with current item quantities\n        const initialQuantityInputs = {};\n        res.data.forEach(item => {\n          initialQuantityInputs[item._id] = item.quantity;\n        });\n        setQuantityInputs(initialQuantityInputs);\n      } catch (err) {\n        console.error(err.response.data);\n      }\n    };\n    fetchItems();\n  }, [refresh]);\n  const onDelete = async id => {\n    try {\n      const config = {\n        headers: {\n          'x-auth-token': localStorage.getItem('token')\n        }\n      };\n      await axios.delete(`/api/items/${id}`, config);\n      setItems(items.filter(item => item._id !== id));\n    } catch (err) {\n      console.error(err.response.data);\n    }\n  };\n  const toggleGraph = itemId => {\n    setShowGraphId(showGraphId === itemId ? null : itemId);\n  };\n  const handleQuantityInputChange = (itemId, value) => {\n    setQuantityInputs({\n      ...quantityInputs,\n      [itemId]: value\n    });\n  };\n  const updateItemQuantity = async (itemId, newQuantity) => {\n    try {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json',\n          'x-auth-token': localStorage.getItem('token')\n        }\n      };\n      const body = JSON.stringify({\n        quantity: newQuantity\n      });\n      await axios.put(`/api/items/${itemId}`, body, config);\n      // Update the item in the local state to reflect the change\n      setItems(items.map(item => item._id === itemId ? {\n        ...item,\n        quantity: newQuantity\n      } : item));\n      // Refresh the graph if it's open for this item\n      if (showGraphId === itemId) {\n        setShowGraphId(null); // Hide and then show to force refresh\n        setTimeout(() => setShowGraphId(itemId), 0);\n      }\n    } catch (err) {\n      console.error(err.response.data);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mb-4 p-3 border rounded bg-dark-card\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"mb-3 text-gold\",\n      children: \"Your Items\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), items.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"No items found. Add a new item above!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"list-group\",\n      children: items.map(item => /*#__PURE__*/_jsxDEV(\"li\", {\n        className: `list-group-item ${item.quantity <= item.minStockThreshold ? 'list-group-item-danger' : ''}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: item.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 17\n          }, this), \" (Store: \", item.store.name, \", Category: \", item.category.name, \") - Price: \", item.store.currency, item.price, \", Quantity: \", item.quantity, \", Min Stock: \", item.minStockThreshold, item.quantity <= item.minStockThreshold && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"badge bg-danger ms-2\",\n            children: \"LOW STOCK!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            className: \"form-control d-inline-block w-auto me-2\",\n            value: quantityInputs[item._id] || '',\n            onChange: e => handleQuantityInputChange(item._id, parseInt(e.target.value) || 0),\n            min: \"0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => updateItemQuantity(item._id, quantityInputs[item._id]),\n            className: \"btn btn-sm btn-info me-2\",\n            children: \"Update Quantity\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => onDelete(item._id),\n            className: \"btn btn-sm btn-danger me-2\",\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => toggleGraph(item._id),\n            className: \"btn btn-sm btn-secondary\",\n            children: showGraphId === item._id ? 'Hide Graph' : 'Show Graph'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 15\n        }, this), showGraphId === item._id && /*#__PURE__*/_jsxDEV(StockEvolutionGraph, {\n          itemId: item._id\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 44\n        }, this)]\n      }, item._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n};\n_s(ItemList, \"6lbMsH22Pi1d/yIDx8ktBh67jUE=\");\n_c = ItemList;\nexport default ItemList;\nvar _c;\n$RefreshReg$(_c, \"ItemList\");","map":{"version":3,"names":["React","useEffect","useState","axios","StockEvolutionGraph","jsxDEV","_jsxDEV","ItemList","refresh","_s","items","setItems","showGraphId","setShowGraphId","quantityInputs","setQuantityInputs","fetchItems","config","headers","localStorage","getItem","res","get","data","initialQuantityInputs","forEach","item","_id","quantity","err","console","error","response","onDelete","id","delete","filter","toggleGraph","itemId","handleQuantityInputChange","value","updateItemQuantity","newQuantity","body","JSON","stringify","put","map","setTimeout","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","minStockThreshold","name","store","category","currency","price","type","onChange","e","parseInt","target","min","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Marina/Desktop/Mon_Projet/stock-app/client/src/components/ItemList.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport StockEvolutionGraph from './StockEvolutionGraph';\n\nconst ItemList = ({ refresh }) => {\n  const [items, setItems] = useState([]);\n  const [showGraphId, setShowGraphId] = useState(null);\n  const [quantityInputs, setQuantityInputs] = useState({}); // State for quantity input fields\n\n  useEffect(() => {\n    const fetchItems = async () => {\n      try {\n        const config = {\n          headers: {\n            'x-auth-token': localStorage.getItem('token'),\n          },\n        };\n        const res = await axios.get('/api/items', config);\n        setItems(res.data);\n        // Initialize quantity inputs with current item quantities\n        const initialQuantityInputs = {};\n        res.data.forEach(item => {\n          initialQuantityInputs[item._id] = item.quantity;\n        });\n        setQuantityInputs(initialQuantityInputs);\n      } catch (err) {\n        console.error(err.response.data);\n      }\n    };\n    fetchItems();\n  }, [refresh]);\n\n  const onDelete = async (id) => {\n    try {\n      const config = {\n        headers: {\n          'x-auth-token': localStorage.getItem('token'),\n        },\n      };\n      await axios.delete(`/api/items/${id}`, config);\n      setItems(items.filter(item => item._id !== id));\n    } catch (err) {\n      console.error(err.response.data);\n    }\n  };\n\n  const toggleGraph = (itemId) => {\n    setShowGraphId(showGraphId === itemId ? null : itemId);\n  };\n\n  const handleQuantityInputChange = (itemId, value) => {\n    setQuantityInputs({\n      ...quantityInputs,\n      [itemId]: value,\n    });\n  };\n\n  const updateItemQuantity = async (itemId, newQuantity) => {\n    try {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json',\n          'x-auth-token': localStorage.getItem('token'),\n        },\n      };\n      const body = JSON.stringify({ quantity: newQuantity });\n      await axios.put(`/api/items/${itemId}`, body, config);\n      // Update the item in the local state to reflect the change\n      setItems(items.map(item =>\n        item._id === itemId ? { ...item, quantity: newQuantity } : item\n      ));\n      // Refresh the graph if it's open for this item\n      if (showGraphId === itemId) {\n        setShowGraphId(null); // Hide and then show to force refresh\n        setTimeout(() => setShowGraphId(itemId), 0);\n      }\n    } catch (err) {\n      console.error(err.response.data);\n    }\n  };\n\n  return (\n    <div className=\"mb-4 p-3 border rounded bg-dark-card\">\n      <h2 className=\"mb-3 text-gold\">Your Items</h2>\n      {items.length === 0 ? (\n        <p>No items found. Add a new item above!</p>\n      ) : (\n        <ul className=\"list-group\">\n          {items.map((item) => (\n            <li\n              key={item._id}\n              className={`list-group-item ${item.quantity <= item.minStockThreshold ? 'list-group-item-danger' : ''}`}\n            >\n              <div>\n                <strong>{item.name}</strong> (Store: {item.store.name}, Category: {item.category.name}) - Price: {item.store.currency}{item.price}, Quantity: {item.quantity}, Min Stock: {item.minStockThreshold}\n                {item.quantity <= item.minStockThreshold && (\n                  <span className=\"badge bg-danger ms-2\">LOW STOCK!</span>\n                )}\n              </div>\n              <div className=\"mt-2\">\n                <input\n                  type=\"number\"\n                  className=\"form-control d-inline-block w-auto me-2\"\n                  value={quantityInputs[item._id] || ''}\n                  onChange={(e) => handleQuantityInputChange(item._id, parseInt(e.target.value) || 0)}\n                  min=\"0\"\n                />\n                <button onClick={() => updateItemQuantity(item._id, quantityInputs[item._id])} className=\"btn btn-sm btn-info me-2\">Update Quantity</button>\n                <button onClick={() => onDelete(item._id)} className=\"btn btn-sm btn-danger me-2\">Delete</button>\n                <button onClick={() => toggleGraph(item._id)} className=\"btn btn-sm btn-secondary\">\n                  {showGraphId === item._id ? 'Hide Graph' : 'Show Graph'}\n                </button>\n              </div>\n              {showGraphId === item._id && <StockEvolutionGraph itemId={item._id} />}\n            </li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n};\n\nexport default ItemList;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}